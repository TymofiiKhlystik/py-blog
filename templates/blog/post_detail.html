{% extends "base.html" %}
{% load crispy_forms_tags %}

{% block content %}
	<div class="container mt-4">

		<div class="card mb-4">
			<div class="card-body">
				<h2 class="card-title">{{ post.title }}</h2>
				<p class="card-text">{{ post.content }}</p>
				<p class="text-muted">By <strong>{{ post.owner }}</strong> at {{ post.created_time }}</p>
			</div>
		</div>

		<h4>Comments ({{ post.comments.count }})</h4>
		<ul class="list-group mb-4">
			{% for comment in post.comments.all %}
				<li class="list-group-item">
					<strong>{{ comment.user }}</strong>
					<p>{{ comment.content }}</p>
					<small class="text-muted">({{ comment.created_time }})</small>
				</li>
			{% empty %}
				<li class="list-group-item">No comments yet.</li>
			{% endfor %}
		</ul>

		<h4>Add a Comment</h4>

		{% if user.is_authenticated %}
			<form method="post">
				{% csrf_token %}
				{{ form|crispy }}
				<button type="submit" class="btn btn-primary">Submit</button>
			</form>
		{% else %}
			<div class="alert alert-warning">
				To post a comment, you must <a href="{% url 'login' %}">login</a>.
			</div>
			<form method="post">
				{% csrf_token %}
				{{ form|crispy }}
				<button type="submit" class="btn btn-primary" disabled>Submit</button>
			</form>
		{% endif %}

		<button type="button" class="btn btn-secondary mt-3" onclick="history.back()">Go Back</button>

	</div>
{% endblock %}
